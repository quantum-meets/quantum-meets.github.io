<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-GB" xml:lang="en-GB">

<head>
  <link rel="stylesheet" href="github.css">
  <link rel="icon" href="/favicon.svg" type="image/svg+xml">
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>Quantum Meets</title>

  <style>
    .markdown-body {
      box-sizing: border-box;
      min-width: 200px;
      max-width: 980px;
      margin: 0 auto;
      padding: 45px;
    }

    @media (max-width: 767px) {
      .markdown-body {
        padding: 15px;
      }
    }

    /* --- Toggle Bar --- */
    .filter-toggle {
      display: inline-flex;
      background: #e0e0e0;
      border-radius: 999px;
      overflow: hidden;
      box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
      margin: 1rem 0;
    }

    .filter-toggle button {
      border: none;
      background: none;
      padding: 0.6rem 1.2rem;
      cursor: pointer;
      font-weight: 500;
      transition: background 0.2s, color 0.2s;
    }

    .filter-toggle button:hover {
      background: rgba(0, 0, 0, 0.08);
    }

    .filter-toggle button.active {
      background: #007bff;
      color: #fff;
    }

    /* Hidden events */
    .hidden {
      display: none;
    }
  </style>

  <script>
    window.MathJax = {
      tex: {
        inlineMath: [['$', '$'], ['\\(', '\\)']],
        displayMath: [['$$', '$$'], ['\\[', '\\]']]
      }
    };
  </script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>
  <script src="https://cdn.jsdelivr.net/npm/darkmode-js@1.5.7/lib/darkmode-js.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>

  <script>
    const darkmode_options = {
      bottom: '32px',
      right: '32px',
      time: '0.3s',
      mixColor: '#fff',
      backgroundColor: '#fff',
      buttonColorDark: '#100f2c',
      buttonColorLight: '#fff',
      saveInCookies: true,
      label: 'âš›',
      autoMatchOsTheme: false
    };
    function addDarkmodeWidget() {
      new Darkmode(darkmode_options).showWidget();
    }
    window.addEventListener('load', addDarkmodeWidget);
  </script>

  <script>
    const markdownUrl_qm = "https://raw.githubusercontent.com/quantum-iiit/quantum-iiit.github.io/refs/heads/main/content.md";

    async function loadSection(headingToExtract, contentID, inputUrl = markdownUrl_qm) {
      const res = await fetch(inputUrl);
      const text = await res.text();
      const level = headingToExtract.match(/^#+/)[0].length;
      const regex = new RegExp(`${headingToExtract}[\\s\\S]*?(?=\\n#{1,${level}}\\s|$)`, "i");
      const match = text.match(regex);
      let section = match ? match[0] : "Section not found.";
      section = section.replace(/^.*\n/, "");
      const html = marked.parse(section);
      document.getElementById(contentID).innerHTML += html;
      MathJax.typesetPromise([document.getElementById(contentID)]);
    }
  </script>
</head>

<body class="markdown-body">
  <h1>Quantum Meets</h1>

  <div id="div_about">
    <script>loadSection("## About", "div_about", markdownUrl_qm)</script>
  </div>

  <h2>Calendar</h2>
  <center>
    <iframe
      src="https://calendar.google.com/calendar/embed?height=550&wkst=1&ctz=Asia%2FKolkata&showPrint=0&hl=en_GB&mode=AGENDA&title=Quantum%20Meets&src=YjAyNDI5YjRkZWQ5Yzc2YTFlNWU2OTE2MjFkOWRhOTI2M2QzMzkzZDU1ZWZiYTc3MDg2ZjhiNjg4NDcwZDU4OUBncm91cC5jYWxlbmRhci5nb29nbGUuY29t&color=%238e24aa"
      style="border: 0; padding: 0px; width: 90%; height: 550px;" frameborder="0" scrolling="no"></iframe>
  </center>
  <br />

  <h2>Upcoming</h2>

  <!-- Filter Toggle -->
  <div class="filter-toggle">
    <button class="active" data-filter="all">All</button>
    <button data-filter="Seminar">Seminar</button>
    <button data-filter="Talk">Talk</button>
    <button data-filter="Colloquium">Colloquium</button>
  </div>

  <div id="div_upcoming">
    <script>loadSection("## Upcoming", "div_upcoming", markdownUrl_qm)</script>
  </div>

  <h2>Pipeline</h2>
  <div id="div_pipeline">
    <script>loadSection("## Pipeline", "div_pipeline", markdownUrl_qm)</script>
  </div>

  <script>
    // Wait for markdown to render, then attach filtering logic
    const upcomingContainer = document.getElementById('div_upcoming');
    const buttons = document.querySelectorAll('.filter-toggle button');

    // Observe changes (i.e., when markdown finishes loading)
    const observer = new MutationObserver(() => {
      const events = upcomingContainer.querySelectorAll('h3, h4, p, li');
      if (events.length === 0) return;

      // Each block that includes a Quantum event title will be wrapped in a div for easy toggling
      upcomingContainer.querySelectorAll('*').forEach(node => {
        if (node.textContent.match(/Quantum (Seminar|Talk|Colloquium)/i)) {
          const wrapper = document.createElement('div');
          wrapper.classList.add('event');
          node.parentNode.insertBefore(wrapper, node);
          wrapper.appendChild(node);
        }
      });

      // Now add filtering logic
      buttons.forEach(btn => {
        btn.addEventListener('click', () => {
          buttons.forEach(b => b.classList.remove('active'));
          btn.classList.add('active');
          const filter = btn.dataset.filter;

          upcomingContainer.querySelectorAll('.event').forEach(ev => {
            const text = ev.textContent;
            const show =
              filter === 'all' ||
              text.includes(`Quantum ${filter}`);
            ev.classList.toggle('hidden', !show);
          });
        });
      });

      observer.disconnect(); // Stop observing after first render
    });

    observer.observe(upcomingContainer, { childList: true, subtree: true });
  </script>
</body>
</html>
